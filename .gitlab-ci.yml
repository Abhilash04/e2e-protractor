image: docker

services:
  - docker:dind

before_script:
  - apk add python python-dev py-pip build-base
  - pip install --quiet docker-compose~=1.23.0
  # - pip install docker-compose (gcc error with latest version)
  # - docker-compose build
  - docker-compose up -d

image: node:latest

    stages:
      - build
      - test

    cache:
      paths:
        - node_modules/

    install_dependencies:
      stage: build
      script:
        - npm install
      artifacts:
        paths:
          - node_modules/

    testing_testing:
      stage: test
      script: npm test